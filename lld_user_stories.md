# Low-Level Design — User Stories

## User Story #1 — Upload Book

**As a Librarian,**  
**I want to upload a book without blocking my work,**  
**so that users can later ask questions about that book.**

### Acceptance Criteria
- บรรณารักษ์สามารถอัปโหลดไฟล์ **PDF ได้ 1 ไฟล์ต่อ 1 หนังสือ**
- ระหว่างที่ไฟล์กำลังอัปโหลด บรรณารักษ์สามารถใช้งานหน้าจออื่น ๆ **ภายในระบบ** ได้ และการอัปโหลดยังคงทำงานอยู่เบื้องหลัง
- ระบบแสดง **สถานะการอัปโหลดและการประมวลผล** (เช่น Uploading, Processing, Ready, Failed)
- ระบบสามารถ **ติดตามความคืบหน้าการประมวลผล** จนกว่าจะเสร็จสมบูรณ์หรือเกิดข้อผิดพลาด

### Functional Scope
- อัปโหลดไฟล์ PDF หนึ่งไฟล์
- จัดเก็บ metadata ของหนังสือ
- ประมวลผลเนื้อหาหนังสือแบบ asynchronous
- แสดงสถานะการประมวลผลให้ frontend

### System Responsibilities
**Frontend**
- แสดง UI สำหรับการอัปโหลด
- อัปโหลดไฟล์ผ่าน **presigned URL**
- แสดงสถานะการประมวลผล

**Backend**
- เริ่มต้นกระบวนการอัปโหลด
- รับสัญญาณหรือการแจ้งเตือนว่าการอัปโหลดเสร็จสมบูรณ์
- จัดการ lifecycle ของหนังสือ
- สร้างงานประมวลผลสำหรับ background worker

**Background Worker**
- ประมวลผลเอกสารที่ถูกอัปโหลด
- อัปเดตผลลัพธ์และสถานะการประมวลผล

### Out of Scope / Assumptions
- รองรับเฉพาะไฟล์ PDF เท่านั้น
- ไม่รองรับการเปลี่ยนไฟล์หลังจากอัปโหลดแล้ว
- ไม่รองรับการอัปโหลดหลายไฟล์พร้อมกัน

---

## User Story #2 — View Uploaded Books

**As a Librarian,**  
**I want to view the list of uploaded books and their processing status,**  
**so that I can monitor upload progress and identify completed or failed books.**

### Acceptance Criteria
- บรรณารักษ์สามารถดู **รายการหนังสือที่อัปโหลดแล้ว**
- หนังสือแต่ละเล่มแสดง **สถานะปัจจุบัน** (Uploading, Processing, Ready, Failed)
- สถานะมีการอัปเดตโดย **ไม่ต้องรีเฟรชหน้าเว็บ**
- หนังสือที่ประมวลผลล้มเหลวสามารถ **แยกแยะได้ชัดเจน** จากเล่มที่สำเร็จ

### Functional Scope
- แสดงรายการหนังสือในรูปแบบ list view
- แสดงสถานะการประมวลผลของแต่ละเล่ม
- อัปเดตหรือรีเฟรชสถานะเมื่อการประมวลผลเปลี่ยนแปลง

### System Responsibilities
**Frontend**
- แสดงรายการหนังสือพร้อมสถานะ
- อัปเดตตัวบ่งชี้สถานะแบบ dynamic

**Backend**
- ให้ API สำหรับดึงรายการหนังสือและสถานะ
- เปิดเผยสถานะการประมวลผลปัจจุบันของหนังสือแต่ละเล่ม

### Out of Scope / Assumptions
- ไม่รองรับการแก้ไขหรือเปลี่ยนไฟล์ที่อัปโหลดแล้ว
- ไม่รวมความสามารถในการลบหรือสั่งประมวลผลใหม่

---

## User Story #3 — Ask AI About Books

**As a Guest,**  
**I want to ask AI about uploaded books,**  
**so that I can get answers, summaries, search results, and locations based on book content.**

### Acceptance Criteria
- ผู้ใช้สามารถถามคำถามได้ **เฉพาะหนังสือที่มีสถานะ `Ready` เท่านั้น**
- หนังสือที่ยังไม่อยู่ในสถานะ `Ready` จะ **ไม่ถูกนำมาใช้ในการตอบคำถาม**
- ระบบสามารถ:
  - ตอบคำถามจากเนื้อหาหนังสือ (Q&A)
  - สรุปเนื้อหาหนังสือหรือบางส่วน
  - ค้นหาหนังสือจากเนื้อหา
  - แสดงตำแหน่งที่มา (หน้า/ส่วน) ของคำตอบ เมื่อมีข้อมูล
- หากไม่พบเนื้อหาที่เกี่ยวข้อง ระบบจะตอบกลับอย่างเหมาะสม

### Functional Scope
- โต้ตอบกับเนื้อหาหนังสือผ่าน AI
- รองรับหลายโหมดการใช้งาน (Q&A, Summary, Search, Location)
- จัดเส้นทางคำขอไปยังโหมดประมวลผลที่เหมาะสม

### System Responsibilities
**Frontend**
- แสดง UI สำหรับการสนทนา
- แสดงคำตอบ สรุป ผลการค้นหา และตำแหน่งอ้างอิง

**Backend**
- จัดเส้นทางคำขอตามโหมดการใช้งาน
- ทำ retrieval จากเนื้อหาหนังสือ
- ประสานการทำงานกับ AI เพื่อสร้างคำตอบ

**Database / Storage**
- จัดเก็บเนื้อหาหนังสือที่ผ่านการประมวลผลและ metadata

### Out of Scope / Assumptions
- ไม่รองรับคำถามที่อยู่นอกเหนือจากเนื้อหาหนังสือ

## User Story #4 — แก้ไขข้อมูลเมตาของหนังสือ

**As a Librarian,**  
**I want to edit book metadata without re-uploading the file,**  
**so that I can correct or update book information easily.**

### Acceptance Criteria
- บรรณารักษ์สามารถแก้ไข **ข้อมูลเมตาของหนังสือ** ได้ (เช่น ชื่อหนังสือ, คำอธิบาย, แท็ก, หมวดหมู่)
- การแก้ไขข้อมูลเมตา **ไม่จำเป็นต้องอัปโหลดไฟล์ PDF ใหม่**
- การแก้ไขข้อมูลเมตา **ไม่กระตุ้นให้เกิดการประมวลผลเอกสารหรือ ETL ใหม่**
- ข้อมูลเมตาที่แก้ไขแล้วถูกแสดงผลในระบบทันที

### Functional Scope
- แก้ไขและบันทึกข้อมูลเมตาของหนังสือ
- จัดเก็บการเปลี่ยนแปลงโดยไม่กระทบไฟล์ต้นฉบับหรือสถานะการประมวลผล
- เปิดเผยข้อมูลเมตาที่อัปเดตแล้วให้ส่วนอื่นของระบบ (เช่น หน้าแสดงรายการ, การค้นหา)

### System Responsibilities
**Frontend**
- แสดง UI สำหรับการแก้ไขข้อมูลเมตาของหนังสือ
- ส่งข้อมูลที่แก้ไขไปยัง backend
- แสดงผลข้อมูลเมตาที่อัปเดตแล้วใน UI

**Backend**
- ตรวจสอบความถูกต้องและบันทึกข้อมูลเมตาที่ถูกแก้ไข
- รับประกันว่าการแก้ไขข้อมูลเมตาจะไม่กระทบสถานะการประมวลผลของเอกสาร
- เปิดเผยข้อมูลเมตาที่อัปเดตผ่าน API ที่มีอยู่

### Out of Scope / Assumptions
- ไม่รองรับการแก้ไขหรือเปลี่ยนไฟล์ PDF ที่อัปโหลดแล้ว
- การแก้ไขข้อมูลเมตาไม่ก่อให้เกิดการประมวลผลใหม่ การสร้าง embedding ใหม่ หรือการทำดัชนีใหม่

